<div class="row">
  <div class="col-lg-12">
    <h1 class="page-header">总体分布散点图</h1>
  </div>
</div>
<div class="panel panel-default">
  <div class="panel-heading">
    <i class="fa fa-bar-chart-o fa-fw"></i> Bar Chart Example
    <div class="pull-right">
      <div class="btn-group">
        <button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown">
          Actions
          <span class="caret"></span>
        </button>
        <ul class="dropdown-menu pull-right" role="menu">
          <li><%= link_to 'heatmap', root_path(chart_type: 'heatmap'), :method => :get %>
          </li>
          <li>
            <%= link_to 'scatter', root_path(chart_type: 'scatter'), :method => :get %>
          </li>
          <li><a href="#">Something else here</a>
          </li>
          <li class="divider"></li>
          <li><a href="#">Separated link</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
  <div class="panel panel-body">
    <div id="main" style="width: 800px;height:500px;"></div>
  </div>
</div>

<script>
  var myChart = echarts.init(document.getElementById('main'));

  $.ajax({
    type: "GET",
    url: "/home/get_collection",
    dataType: 'json',
    success: function (data) {
      var house_data = [];
      $.each(data, function (index, house) {
        var each_house = [];
        each_house.push(house.longitude, house.latitude);
        house_data.push(each_house);
      });

      myChart.setOption({
        backgroundColor: '#404a59',
        title: {
          text: '北京房价总体图',
          x: 'center',
          textStyle: {
            color: 'black'
          }
        },
        legend: {
          orient: 'vertical',
          y: 'bottom',
          x: 'right',
          data: ['价格'],
          textStyle: {
            color: '#fff'
          }
        },
        visualMap: {
          show: false,
          top: 'top',
          min: 0,
          max: 5,
          seriesIndex: 0,
          calculable: true,
          inRange: {
            color: ['blue', 'blue', 'green', 'yellow', 'red']
          }
        },
        bmap: {
          center: [116.404, 39.915],
          zoom: 12,
          roam: true
        },
        series: [{
          name: 'house',
          type: 'heatmap',
          coordinateSystem: 'bmap',
          data: house_data,
          symbolSize: 12,
          pointSize: 6,
          blurSize: 20
        }]
      });
    },
    error: function () {
      alert('error')
    },
    timeout: function () {
      alert('time out')
    }
  });

</script>


