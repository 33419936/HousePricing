<div id="l-map">
</div>

<div id="r-result">

  <input type="button" value="获得数据" onclick="getData()"/>
  <div id="result"></div>

</div>

<script type="text/javascript">

  // 百度地图API功能
  var map = new BMap.Map("l-map", {
    enableMapClick: false
  });    // 创建Map实例
  map.centerAndZoom(new BMap.Point(105.403119, 38.028658), 5);  // 初始化地图,设置中心点坐标和地图级别
  map.enableScrollWheelZoom(true); // 开启鼠标滚轮缩放

  map.setMapStyle({
    style: 'midnight'
  });

  var randomCount = 300;

  var data = [];

  var citys = ["北京","天津","上海","重庆","石家庄","太原","呼和浩特","哈尔滨","长春","沈阳","济南","南京","合肥","杭州","南昌","福州","郑州","武汉","长沙","广州","南宁","西安","银川","兰州","西宁","乌鲁木齐","成都","贵阳","昆明","拉萨","海口"];

  // 构造数据
  while (randomCount--) {
    var cityCenter = mapv.utilCityCenter.getCenterByCityName(citys[parseInt(Math.random() * citys.length)]);
    data.push({
      geometry: {
        type: 'Point',
        coordinates: [cityCenter.lng - 2 + Math.random() * 4, cityCenter.lat - 2 + Math.random() * 4]
      },
      count: 30 * Math.random()
    });
  }

  var dataSet = new mapv.DataSet(data);

  var options = {
    fillStyle: 'rgba(55, 50, 250, 0.8)',
    shadowColor: 'rgba(255, 250, 50, 1)',
    shadowBlur: 20,
    size: 40,
    globalAlpha: 0.5,
    gradient: { 0.25: "rgb(0,0,255)", 0.55: "rgb(0,255,0)", 0.85: "yellow", 1.0: "rgb(255,0,0)"},
    draw: 'grid'
  };

  var mapvLayer = new mapv.baiduMapLayer(map, dataSet, options);


//   百度地图API功能
//  var map = new BMap.Map("l-map");
//  map.centerAndZoom(new BMap.Point(116.404, 40.095), 11);
//  map.enableScrollWheelZoom(true);
//  var index = 0;
//  var myGeo = new BMap.Geocoder();
//
//  function geocodeSearch(add, index) {
//    myGeo.getPoint(add, function (point) {
//      if (point) {
//        var address = new BMap.Point(point.lng, point.lat);
//        addMarker(address, new BMap.Label(index + ":" + add, {offset: new BMap.Size(20, -10)}));
//      }
//    }, "北京市");
//  }
//
//  // 编写自定义函数,创建标注
//  function addMarker(point, label) {
//    var marker = new BMap.Marker(point);
//    map.addOverlay(marker);
//    marker.setLabel(label);
//  }
//
//
//    var local = new BMap.LocalSearch(map, {
//      renderOptions:{map: map, panel:"r-result"},
//      pageCapacity:5
//    });
//
//    local.searchInBounds(myKeys, map.getBounds());
//
//
//  function getData() {
//    $.ajax({
//      type: "GET",
//      url: "/ajax",
//      dataType: 'json',
//      success: function (data) {
//
////        var adds = [];
//        $.each(data, function (index, element) {
////          adds.push(element.location);
//
//          geocodeSearch(element.community, index);
//        });
//
//      },
//      error: function () {
//        alert('error')
//      },
//      timeout: function () {
//        alert('time out')
//      }
//    })
//  }


</script>

<style type="text/css">

  #l-map {
    height: 500px;
    width: 100%;
  }

  #r-result {
    width: 100%;
    font-size: 14px;
    line-height: 20px;
  }
</style>
