<div class="row">
  <div class="col-lg-12">
    <h1 class="page-header">Dashboard</h1>
  </div>
</div>

<div class="panel panel-default">
  <div class="panel-heading">
    <text class="panel-title">二手房数据</text>
    <div class="pull-right">
      <%= link_to "整合周边数据", rollup_houses_path, class: "btn btn-primary btn-xs" %>
      <%= link_to "删除无坐标数据", filter_houses_path, class: "btn btn-danger btn-xs" %>
    </div>
  </div>
  <div class="panel-body" style="min-height:750px">

    <div class="row">

      <div class="col col-sm-6">
        <% unless params[:query].blank? %>
            <text class="text-danger">搜索结果显示:
              <mark><%= params[:query] %></mark>
            </text>
        <% end %>
      </div>

      <div class="col col-sm-1 pull-right">
        <%= form_tag export_houses_path(:format => :csv), :method => :get, class: "pull-right" do %>
            <%= hidden_field_tag :query, params[:query] %>
            <%= button_tag(type: "submit", class: "btn btn-success btn-sm") do %>
                <span class="glyphicon glyphicon-floppy-save"></span> 导出
            <% end %>
        <% end %>
      </div>

      <div class="col col-sm-3 pull-right">
        <%= form_tag houses_path, method: 'get', role: "search" do %>
            <div class="input-group">
              <%= text_field_tag 'query', params[:query], class: "form-control input-sm", placeholder: "关键字" %>
              <div class="input-group-btn">
                <button class="btn btn-default btn-sm" type="submit"><i class="glyphicon glyphicon-search"></i>
                </button>
              </div>
            </div>
        <% end %>
      </div>

    </div>

    <hr>

    <table class="table table-responsive table-condensed table-hover">
      <thead>
      <tr>
        <th>小区名</th>
        <!--<th>街道</th>-->
        <th>建造时间</th>
        <th>楼层</th>
        <th>面积</th>
        <th>房型</th>
        <!--<th>经度</th>-->
        <!--<th>纬度</th>-->
        <th>医院</th>
        <th>公交</th>
        <th>商场</th>
        <th>地铁</th>
        <th>学校</th>
        <th>写字楼</th>
        <th>据天安门距离</th>
        <th>每平米价格</th>

      </tr>
      </thead>
      <tbody>
      <% @houses.each do |house| %>
          <tr>
            <td>
              <text style="font-size: small"><%= link_to "#{house.community}", house_path(house) %></text>
            </td>

            <td>
              <text style="font-size: small"><%= house.build_time %></text>
            </td>
            <td>
              <text style="font-size: small"><%= house.floor %></text>
            </td>
            <td>
              <text style="font-size: small"><%= house.area %></text>
            </td>
            <td>
              <text style="font-size: small"><%= house.room_shape %></text>
            </td>
            <!--<td>-->
            <!--<text style="font-size: small"><%#= house.latitude %></text>-->
            <!--</td>-->
            <!--<td>-->
            <!--<text style="font-size: small"><%#= house.longitude %></text>-->
            <!--</td>-->
            <td>
              <text style="font-size: small"><%= house.hospital_num %></text>
            </td>
            <td>
              <text style="font-size: small"><%= house.bus_num %></text>
            </td>
            <td>
              <text style="font-size: small"><%= house.shop_num %></text>
            </td>
            <td>
              <text style="font-size: small"><%= house.subway_num %></text>
            </td>
            <td>
              <text style="font-size: small"><%= house.school_num %></text>
            </td>
            <td>
              <text style="font-size: small"><%= house.work_num %></text>
            </td>

            <td>
              <text style="font-size: small"><%= house.distance %></text>
            </td>

            <td>
              <text style="font-size: small"><%= house.average_price %></text>
            </td>

          </tr>
      <% end %>


      </tbody>
    </table>

    <%= will_paginate @houses, :param_name => 'page',
                      :previous_label => t("前一页"), :next_label => t("后一页"), :inner_window => 1 %>

  </div>
</div>

